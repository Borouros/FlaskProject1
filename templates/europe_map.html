<!DOCTYPE html>
<html lang="en">
<head>
  <title>Europe Map with Capitals</title>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
  <style>
    body { margin: 0; padding: 0; }
    #map { height: 100vh; width: 100%; }
    .country-label {
      font-weight: bold;
      color: #000;
      font-size: 13px;
      text-shadow: 1px 1px 2px white;
      pointer-events: none;
      text-align: center;
    }
    .leaflet-popup-content input { width: 120px; margin-right: 5px; }
  </style>
</head>
<body>
<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
// Capitals dictionary (expand as needed)
const capitals = {
      "Albania":[41.3275,19.8189],"Andorra":[42.5078,1.5211],"Austria":[48.2082,16.3738],
      "Belarus":[53.9,27.5667],"Belgium":[50.8503,4.3517],"Bosnia and Herzegovina":[43.8563,18.4131],
      "Bulgaria":[42.6977,23.3219],"Croatia":[45.815,15.9819],"Cyprus":[35.1856,33.3823],
      "Czechia":[50.0755,14.4378],"Denmark":[55.6761,12.5683],"Estonia":[59.437,24.7536],
      "Finland":[60.1699,24.9384],"France":[48.8566,2.3522],"Germany":[52.52,13.405],
      "Greece":[37.9838,23.7275],"Hungary":[47.4979,19.0402],"Iceland":[64.1466,-21.9426],
      "Ireland":[53.3498,-6.2603],"Italy":[41.9028,12.4964],"Kosovo":[42.6629,21.1655],
      "Latvia":[56.9496,24.1052],"Liechtenstein":[47.141,9.5215],"Lithuania":[54.6872,25.2797],
      "Luxembourg":[49.6116,6.1319],"Malta":[35.8989,14.5146],"Moldova":[47.0105,28.8638],
      "Monaco":[43.7384,7.4246],"Montenegro":[42.4304,19.2594],"Netherlands":[52.3676,4.9041],
      "North Macedonia":[41.9981,21.4254],"Norway":[59.9139,10.7522],"Poland":[52.2297,21.0122],
      "Portugal":[38.7169,-9.139],"Romania":[44.4268,26.1025],"San Marino":[43.9356,12.4473],
      "Serbia":[44.8176,20.4569],"Slovakia":[48.1486,17.1077],"Slovenia":[46.0569,14.5058],
      "Spain":[40.4168,-3.7038],"Sweden":[59.3293,18.0686],"Switzerland":[46.9481,7.4474],
      "Turkey":[39.9208,32.8541],"Ukraine":[50.45,30.5236],"United Kingdom":[51.5074,-0.1278],
      "Vatican":[41.9022,12.4539]
    };

const customNames = {
  "Albania": "syri",
  "Andorra": "ull",
  "Austria": "Auge",
  "Belarus": "вока",
  "Belgium": "œil",       // French
  "Bosnia and Herzegovina": "oko",
  "Bulgaria": "око",
  "Croatia": "oko",
  "Cyprus": "μάτι",       // Greek
  "Czechia": "oko",
  "Denmark": "øje",
  "Estonia": "silm",
  "Finland": "silmä",
  "France": "œil",
  "Germany": "Auge",
  "Greece": "μάτι",
  "Hungary": "szem",
  "Iceland": "auga",
  "Ireland": "súil",
  "Italy": "occhio",
  "Kosovo": "syri",
  "Latvia": "acs",
  "Liechtenstein": "Auge",
  "Lithuania": "akis",
  "Luxembourg": "Aen",
  "Malta": "għajn",
  "Moldova": "ochi",
  "Monaco": "œil",
  "Montenegro": "oko",
  "Netherlands": "oog",
  "North Macedonia": "око",
  "Norway": "øye",
  "Poland": "oko",
  "Portugal": "olho",
  "Romania": "ochi",
  "San Marino": "occhio",
  "Serbia": "око",
  "Slovakia": "oko",
  "Slovenia": "oko",
  "Spain": "ojo",
  "Sweden": "öga",
  "Switzerland": "Auge",
  "Turkey": "göz",
  "Ukraine": "око",
  "United Kingdom": "eye",
  "Vatican": "occhio"
};


// LocalStorage helpers
function getStoredNames() {
    return JSON.parse(localStorage.getItem('renamedCountries') || '{}');
}
function saveStoredNames(names) {
    localStorage.setItem('renamedCountries', JSON.stringify(names));
}

// Random color generator
function getRandomColor() {
    const letters = '0123456789ABCDEF';
    let color = '#';
    for (let i = 0; i < 6; i++) color += letters[Math.floor(Math.random() * 16)];
    return color;
}

// Map setup
let map = L.map('map', {
    center: [54, 15],
    zoom: 4,
    minZoom: 3,
    maxZoom: 7,
    maxBounds: [[34, -25], [72, 45]],
    maxBoundsViscosity: 1.0
});
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

fetch('https://raw.githubusercontent.com/leakyMirror/map-of-europe/master/GeoJSON/europe.geojson')
.then(res => res.json())
.then(data => {
    const storedNames = getStoredNames();
const labelMarkers = {};

L.geoJSON(data, {
    style: () => ({
        color: "#333",
        weight: 1,
        fillColor: getRandomColor(),
        fillOpacity: 0.7
    }),
    onEachFeature: (feature, layer) => {
        const originalName = feature.properties.name;

        // Use stored name if available, otherwise custom name, otherwise original
        const displayName = storedNames[originalName] || customNames[originalName] || originalName;

        // Place label on capital or centroid
        let coords = capitals[originalName] || layer.getBounds().getCenter();
        const label = L.marker(coords, {
            icon: L.divIcon({
                className: "country-label",
                html: displayName,
                iconSize: [100, 20]
            })
        }).addTo(map);
        labelMarkers[originalName] = label;

        // Popup for renaming
        layer.bindPopup(() => {
            const container = document.createElement('div');
            container.innerHTML = `
                <b>${displayName}</b><br>
                <input type="text" placeholder="Rename..." value="${displayName}">
                <button>Save</button>
            `;

            const input = container.querySelector('input');
            const button = container.querySelector('button');

            button.addEventListener('click', () => {
                const newName = input.value.trim();
                if (!newName) return;

                // Save in localStorage
                storedNames[originalName] = newName;
                saveStoredNames(storedNames);

                // Update label immediately
                label.setIcon(L.divIcon({
                    className: "country-label",
                    html: newName,
                    iconSize: [100, 20]
                }));

                layer.closePopup();
            });

            return container;
        });
    }
}).addTo(map);

});
</script>
</body>
</html>
