<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Europe Map</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
  <style>
    #map { height: 100vh; width: 100%; }
    .country-label {
      font-size: 14px;
      font-weight: bold;
      text-align: center;
      color: black;
      text-shadow: 1px 1px 2px white;
    }
    .hover-info {
      position: absolute;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 8px 12px;
      border-radius: 4px;
      pointer-events: none;
      z-index: 1000;
      font-size: 14px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }
    .hover-info h4 {
      margin: 0 0 4px 0;
      font-size: 16px;
    }
    .hover-info p {
      margin: 2px 0;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <div id="hover-info" class="hover-info" style="display: none;"></div>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // ===== Constants =====
    const capitals = {
      "Albania": [41.3275, 19.8189], "Andorra": [42.5078, 1.5211], "Austria": [48.2082, 16.5738],
      "Belarus": [53.9, 27.5667], "Belgium": [50.8503, 4.3517], "Bosnia and Herzegovina": [43.8563, 18.4131],
      "Bulgaria": [42.6977, 23.3219], "Croatia": [45.8150, 15.9819], "Cyprus": [35.1856, 33.3823],
      "Czechia": [50.0755, 14.4378], "Denmark": [55.6761, 12.5683], "Estonia": [59.437, 24.7536],
      "Finland": [60.1699, 24.9384], "France": [48.8566, 2.3522], "Germany": [52.52, 13.405],
      "Greece": [37.9838, 23.7275], "Hungary": [47.4979, 19.0402], "Iceland": [64.1466, -21.9426],
      "Ireland": [53.3498, -6.2603], "Italy": [41.9028, 12.4964], "Kosovo": [42.6629, 21.1655],
      "Latvia": [56.9496, 24.1052], "Liechtenstein": [47.141, 9.5215], "Lithuania": [54.6872, 25.2797],
      "Luxembourg": [49.6116, 6.1319], "Malta": [35.8989, 14.5146], "Moldova": [47.0105, 28.8638],
      "Monaco": [43.7384, 7.4246], "Montenegro": [42.4304, 19.2594], "Netherlands": [52.3676, 4.9041],
      "North Macedonia": [41.9981, 21.4254], "Norway": [59.9139, 10.7522], "Poland": [52.2297, 21.0122],
      "Portugal": [38.7169, -9.139], "Romania": [44.4268, 26.1025], "San Marino": [43.9356, 12.4473],
      "Serbia": [44.8176, 20.4569], "Slovakia": [48.1486, 17.1077], "Slovenia": [46.0569, 14.5058],
      "Spain": [40.4168, -3.7038], "Sweden": [59.3293, 18.0686], "Switzerland": [46.9481, 7.4474],
      "Turkey": [39.9208, 32.8541], "Ukraine": [50.45, 30.5236], "United Kingdom": [51.5074, -0.1278],
      "Vatican": [41.9022, 12.4539]
    };

    const customNames = {
      "Albania": "syri", "Andorra": "ull", "Austria": "Auge", "Belarus": "вока", "Belgium": "œil",
      "Bosnia and Herzegovina": "oko", "Bulgaria": "око", "Croatia": "oko", "Cyprus": "μάτι", "Czechia": "oko",
      "Denmark": "øje", "Estonia": "silm", "Finland": "silmä", "France": "œil", "Germany": "Auge",
      "Greece": "μάτι", "Hungary": "szem", "Iceland": "auga", "Ireland": "súil", "Italy": "occhio",
      "Kosovo": "syri", "Latvia": "acs", "Liechtenstein": "Auge", "Lithuania": "akis", "Luxembourg": "Aen",
      "Malta": "għajn", "Moldova": "ochi", "Monaco": "œil", "Montenegro": "oko", "Netherlands": "oog",
      "North Macedonia": "око", "Norway": "øye", "Poland": "oko", "Portugal": "olho", "Romania": "ochi",
      "San Marino": "occhio", "Serbia": "око", "Slovakia": "око", "Slovenia": "око", "Spain": "ojo",
      "Sweden": "öga", "Switzerland": "Auge", "Turkey": "göz", "Ukraine": "око", "United Kingdom": "eye",
      "Vatican": "occhio"
    };

    const pronunciations = {
      "Albania": "SY-ree", "Andorra": "ool", "Austria": "OW-geh", "Belarus": "VOH-ka", "Belgium": "uh-y",
      "Bosnia and Herzegovina": "OH-ko", "Bulgaria": "OH-ko", "Croatia": "OH-ko", "Cyprus": "MAH-tee",
      "Czechia": "OH-ko", "Denmark": "UR-yeh", "Estonia": "silm", "Finland": "SIL-mah", "France": "uh-y",
      "Germany": "OW-geh", "Greece": "MAH-tee", "Hungary": "sem", "Iceland": "OW-ga", "Ireland": "SOO-il",
      "Italy": "OH-kee-oh", "Kosovo": "SY-ree", "Latvia": "ahts", "Liechtenstein": "OW-geh", "Lithuania": "AH-kis",
      "Luxembourg": "ah-en", "Malta": "ah-yn", "Moldova": "OH-kee", "Monaco": "uh-y", "Montenegro": "OH-ko",
      "Netherlands": "ohg", "North Macedonia": "OH-ko", "Norway": "UR-yeh", "Poland": "OH-ko", "Portugal": "OH-lyo",
      "Romania": "OH-kee", "San Marino": "OH-kee-oh", "Serbia": "OH-ko", "Slovakia": "OH-ko", "Slovenia": "OH-ko",
      "Spain": "OH-ho", "Sweden": "UR-ga", "Switzerland": "OW-geh", "Turkey": "gurz", "Ukraine": "OH-ko",
      "United Kingdom": "ahy", "Vatican": "OH-kee-oh"
    };

    const countryColors = [ '#3498db', '#e74c3c', '#2ecc71', '#f39c12', '#9b59b6', '#1abc9c', '#34495e', '#e67e22', '#95a5a6', '#f1c40f' ];
    let colorIndex = 0;
    function getNextColor() { return countryColors[colorIndex++ % countryColors.length]; }

    function normalizeName(name) {
      const nameMap = {
        "Republic of Albania": "Albania", "Principality of Andorra": "Andorra", "Republic of Austria": "Austria",
        "Republic of Belarus": "Belarus", "Kingdom of Belgium": "Belgium", "Republic of Bulgaria": "Bulgaria",
        "Republic of Croatia": "Croatia", "Republic of Cyprus": "Cyprus", "Czech Republic": "Czechia",
        "Kingdom of Denmark": "Denmark", "Republic of Estonia": "Estonia", "Republic of Finland": "Finland",
        "French Republic": "France", "Federal Republic of Germany": "Germany", "Hellenic Republic": "Greece",
        "Republic of Iceland": "Iceland", "Italian Republic": "Italy", "Republic of Kosovo": "Kosovo",
        "Republic of Latvia": "Latvia", "Principality of Liechtenstein": "Liechtenstein", "Republic of Lithuania": "Lithuania",
        "Grand Duchy of Luxembourg": "Luxembourg", "Republic of Malta": "Malta", "Republic of Moldova": "Moldova",
        "Principality of Monaco": "Monaco", "Kingdom of the Netherlands": "Netherlands", "Republic of North Macedonia": "North Macedonia",
        "Kingdom of Norway": "Norway", "Republic of Poland": "Poland", "Portuguese Republic": "Portugal",
        "Republic of San Marino": "San Marino", "Republic of Serbia": "Serbia", "Slovak Republic": "Slovakia",
        "Republic of Slovenia": "Slovenia", "Kingdom of Spain": "Spain", "Kingdom of Sweden": "Sweden",
        "Swiss Confederation": "Switzerland", "Republic of Türkiye": "Turkey",
        "United Kingdom of Great Britain and Northern Ireland": "United Kingdom",
        "Vatican City State": "Vatican"
      };
      return nameMap[name] || name;
    }

    // ===== Local Storage Helpers =====
    function getStoredNames() { return JSON.parse(localStorage.getItem('renamedCountries') || '{}'); }
    function saveStoredNames(names) { localStorage.setItem('renamedCountries', JSON.stringify(names)); }

    // ===== Hover Info Functions =====
    const hoverInfo = document.getElementById('hover-info');

    function showHoverInfo(e, country, displayName) {
      const pron = pronunciations[country] || "";
      const word = customNames[country] || "";
      
      hoverInfo.innerHTML = `
        <h4>${country}</h4>
        <p><strong>Word:</strong> ${word}</p>
        <p><strong>Pronunciation:</strong> <i>${pron}</i></p>
        ${displayName !== word ? `<p><strong>Custom Name:</strong> ${displayName}</p>` : ''}
      `;
      
      hoverInfo.style.display = 'block';
      hoverInfo.style.left = (e.pageX + 10) + 'px';
      hoverInfo.style.top = (e.pageY + 10) + 'px';
    }

    function hideHoverInfo() {
      hoverInfo.style.display = 'none';
    }

    function updateHoverInfo(e) {
      hoverInfo.style.left = (e.pageX + 10) + 'px';
      hoverInfo.style.top = (e.pageY + 10) + 'px';
    }

    // ===== Map Setup =====
    const map = L.map('map').setView([54, 15], 4);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
    let countryMarkers = {};

    fetch('https://raw.githubusercontent.com/johan/world.geo.json/master/countries.geo.json')
      .then(res => res.json())
      .then(data => {
        const storedNames = getStoredNames();

        L.geoJSON(data, {
          style: feature => {
            const name = normalizeName(feature.properties.name);
            if (!(name in capitals)) return { fillOpacity: 0 };
            return {
              color: "#000",
              weight: 1,
              fillColor: getNextColor(),
              fillOpacity: 0.6
            };
          },
          onEachFeature: (feature, layer) => {
            const country = normalizeName(feature.properties.name);
            if (!(country in capitals)) return;

            const displayName = storedNames[country] || customNames[country] || country;
            const capitalCoords = capitals[country];

            // Marker at capital
            const marker = L.marker(capitalCoords, {
              icon: L.divIcon({
                className: "country-label",
                html: displayName,
                iconSize: [100, 20],
                iconAnchor: [50, 10]
              })
            }).addTo(map);

            countryMarkers[country] = marker;

            // Hover events for the country polygon
            layer.on('mouseover', function(e) {
              showHoverInfo(e.originalEvent, country, displayName);
              this.setStyle({
                weight: 3,
                fillOpacity: 0.8
              });
            });

            layer.on('mouseout', function(e) {
              hideHoverInfo();
              this.setStyle({
                weight: 1,
                fillOpacity: 0.6
              });
            });

            layer.on('mousemove', function(e) {
              updateHoverInfo(e.originalEvent);
            });

            // Click popup for renaming (keeping original functionality)
            const pron = pronunciations[country] || "";
            layer.bindPopup(`
              <b>${displayName}</b><br>
              Pronunciation: <i>${pron}</i><br>
              <input type="text" id="newName-${country}" placeholder="Rename...">
              <button onclick="rename('${country}')">Save</button>
            `);

            // Hover events for the marker as well
            marker.on('mouseover', function(e) {
              showHoverInfo(e.originalEvent, country, displayName);
            });

            marker.on('mouseout', function(e) {
              hideHoverInfo();
            });

            marker.on('mousemove', function(e) {
              updateHoverInfo(e.originalEvent);
            });
          }
        }).addTo(map);
      });

    // ===== Rename Function =====
    function rename(country) {
      const input = document.getElementById(`newName-${country}`);
      if (!input) return;
      const newName = input.value.trim();
      if (!newName) return;

      const names = getStoredNames();
      names[country] = newName;
      saveStoredNames(names);

      const marker = countryMarkers[country];
      if (marker) {
        marker.setIcon(L.divIcon({
          className: "country-label",
          html: newName,
          iconSize: [100, 20],
          iconAnchor: [50, 10]
        }));
      }
    }

    // Hide hover info when mouse leaves the map
    map.on('mouseout', hideHoverInfo);
  </script>
</body>
</html>